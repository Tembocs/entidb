# Follow-up Review Findings (from docs/todo themes)

**Note:** This document has been reviewed for duplicates against prior todo files.
All issues have been FIXED.

---

## FIXED ISSUES

### ~~1) WASM commit/put/delete are non-durable without save()~~
**Status:** FIXED
**Fix:** Inverted the API - `put()`, `delete()`, and `commit()` are now durable by default.
Added explicit `putFast()`, `deleteFast()`, and `commitFast()` for non-durable operations.
Changed in `web/entidb_wasm/src/database.rs`.

### ~~2) Index access paths are still user-selectable via explicit hash/btree/fts index APIs~~
**Status:** FIXED
**Fix:** Deprecated `hash_index_lookup()`, `btree_index_lookup()`, and `btree_index_range()` APIs
in both `entidb_core::Database` and WASM bindings with `#[deprecated]` attributes.
Documentation notes the invariant violation per AGENTS.md section 4.5.

### ~~3) Index rebuild errors are ignored during open and index creation~~
**Status:** FIXED
**Fix:** Changed `let _ = index_engine.rebuild_from_iterator()` to proper error handling.
On open: warnings are logged via `eprintln!`. On explicit index creation: errors propagate to caller.
Changed in `crates/entidb_core/src/database.rs`.

### ~~4) CLI backup opens the SEGMENTS directory as a single segment file and uses current_seq=0~~
**Status:** FIXED
**Fix:** Rewrote backup command to use `Database::open()` and `db.backup()` API which correctly
obtains the committed sequence from the transaction manager.
Changed in `crates/entidb_cli/src/commands/backup.rs`.

### ~~5) CLI restore writes only a segment file and skips MANIFEST/WAL metadata~~
**Status:** FIXED
**Fix:** Rewrote restore command to use `Database::open()` and `db.restore()` API which correctly
creates the database structure including MANIFEST and imports entities via transactions.
Changed in `crates/entidb_cli/src/commands/backup.rs`.

### ~~6) IndexedDb fallback still uses localStorage (not a byte store)~~
**Status:** FIXED
**Fix:** Created new `RealIndexedDbBackend` module that uses actual IndexedDB APIs via web-sys
(IdbFactory, IdbDatabase, IdbObjectStore, etc.) instead of the localStorage stub.
Updated `PersistentBackend` to use the new implementation.
Changed in `web/entidb_wasm/src/backend/indexeddb_real.rs` and `persistent.rs`.